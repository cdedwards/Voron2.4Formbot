[gcode_macro RESET_USER_Z]
description: Reset user Z adjust on top of probe/model offset
gcode:
  # Reset any live gcode offset first
  SET_GCODE_OFFSET Z=0 MOVE=0

[gcode_macro APPLY_USER_Z]
description: Apply saved user Z adjust on top of probe/model offset
gcode:
  # Reset any live gcode offset first
  SET_GCODE_OFFSET Z=0 MOVE=0

  {% set adj = printer.save_variables.variables.user_z_adj|default(0.0)|float %}
  SET_GCODE_OFFSET Z={adj} MOVE=1
  RESPOND MSG="User Z adjust applied: {adj|round(3)} mm"